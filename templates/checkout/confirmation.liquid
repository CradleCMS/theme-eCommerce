{% assign confirmationTitle = 'Order confirmation' %}
{% title confirmationTitle %}
<section class="mx-auto flex flex-col items-center prose">
    <h1 class="text-center">{{confirmationTitle}}</h1>
    <div class="w-full border border-1 border-base-300 rounded p-4 bg-base-100">
        <h2 class="text-center">Receipt</h2>
        <div class="flex flex-row px-2">
            <img src="/favicon-32.png" alt="logo" tabindex="0">
            <h3 class="place-items-center ml-2">{{site.name}}</h3>
        </div>
        <fieldset>
            <div class="grid grid-cols-2 px-2">
                <div>Order date</div>
                <div>{{ order.createdAt | date }}</div>
                <div>Reference</div>
                <div class="font-mono">{{ order.reference | reverse | truncate:8,'' | reverse }}</div>
                <div>Payment</div>
                <div>{{ order.payment | split:'_' | last }}</div>
                <div>Contact</div>
                <div>{{ order.customerName }}</div>
                <div>Email</div>
                <div>{{ order.customerEmail }}</div>
                <div>Country</div>
                <div>{{ countries[order.country].name }} [{{order.country}}]</div>
            </div>
            <div class="border-t border-base-300 mt-2">
                <p class="px-2">Line items</p>
                <div class="grid grid-cols-4 px-2">
                {% for item in order.items %}
                    <div class="col-span-2 flex gap-2 mb-4">
                        <img src="{{item | product_img_url:'thumb'}}" class="rounded" style="margin:auto 0; display:inline-block"/>
                        {% let vt = item.title | split:'|' %} 
                        <span>
                            <strong>{{ vt | first }}</strong>
                            {% if vt.size > 1 %}
                                <br>
                                <em>{{ vt | slice:1 | join }}</em>
                            {% endif %}
                        </span>
                    </div>
                    <div class="text-right col-span-2">
                        <em class="text-xs">({{ item.price | money }}&times;{{ item.quantity }})</em>     
                        <span class="ml-4">{{ item.amount | money }}</span>
                    </div>
        	    {% endfor %}
                <div class="col-span-2"></div>
                    <div class="col-span-2 place-self-center text-right border-t w-full mt-4">
                        {% if shop.priceIncludesVat %}
                            {% assign x = order.amount.sub %}
                            {% assign y = order.amount.vat %}
                            {% assign totalProducts = x | plus:y %}
                            <div class="grid grid-cols-2 mt-2">
                                <em>Items total</em>
                                <div class="ml-auto">{{ totalProducts | money }}</div>
                            </div>
                            <div class="grid grid-cols-2 text-sm">
                                <em>Included taxes</em>
                                <div class="ml-auto">{{ order.amount.vat | money }}</div>
                            </div>
                        {% else %}
                            <div class="grid grid-cols-2">
                                <em>Subtotal</em>
                                <div class="ml-auto">{{ order.amount.sub | money }}</div>
                            </div>
                            <div class="grid grid-cols-2">
                                <em>Taxes</em>
                                <div class="ml-auto">{{ order.amount.vat | money }}</div>
                            </div>
                        {% endif %}
                        {% if order.shipping != empty %}
                             <div class="grid grid-cols-2 mt-2">
                                <em>Shipping</em>
                                <div class="ml-auto">{{ order.shipping.cost.total | money }}</div>
                            </div>
                            <div class="grid grid-cols-2 ml-2 text-sm">
                                <em>handling &amp; delivery</em>
                                <div class="ml-auto">{{ order.shipping.cost.sub | money }}</div>
                            </div>
                            <div class="grid grid-cols-2 ml-2 text-sm">
                                <em>taxes</em>
                                <div class="ml-auto">{{ order.shipping.cost.totalTax | money }}</div>
                            </div>
                        {% endif %} 
                        <div class="grid grid-cols-2 mt-2">
                            <strong>Total amount</strong>
                            <div class="ml-auto font-bold"><strong>{{ order.totalAmount | money }}</strong></div>
                        </div>
                    </div>
                </div>                
            </div>
            <div class="border-t w-full mt-4 border-base-300 text-center pt-2">
                <span class="text-sm opacity-75">{{ site.name }}, {{ site.organisation }}, {{ site.location }}. {{ site.contact }}</span>
            </div>
        </fieldset>
    </div>
        <div class="text-center">
            <p class="font-bold">Thank you for purchasing our products!</p>
            <div role="alert" class="alert alert-bordered bg-base-100">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                class="stroke-gray-400 h-8 w-8 shrink-0">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1"
                  d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <div>
                <div>Order confirmation email sent to <span class="font-bold">{{ order.customerEmail }}</span></div>
                <div class="text-xs">Login to your <a href="/customer/account">account</a> page to see your order status and history.</div>
              </div>
            </div>
        </div>
    </div>
</section>
