<section class="p-10 prose mx-auto">
    <div class="card bg-base-100 text-base-content shrink-0 w-full max-w-m {{ settings.general_shadow }} ">
        {% form 'customer_login' id:'customer_login' class:'customer' %}
            <div class="card-body">
                <h3 class="text-center">{{ 'Log in' | t }}</h3>
                {% include 'formErrorsCustom' %}
                <div>
                    <label class="input validator w-full">
                        <span class="w-20">{{ 'Email' | t}}</span>
                        <input class="w-full px-2" type="email" name="customer[email]" value="" placeholder="mail@domain.com" autocorrect="off" autocapitalize="off" required />
                    </label>
                    <div class="validator-hint hidden m-0">{{ 'Enter valid email address' | t }}</div>
                </div>
                <label class="input validator w-full">
                    <span class="w-20">{{ 'Password' | t }}</span>
                    <input class="w-full px-2" type="password" name="customer[password]" class="grow" value="" placeholder="{{ 'Password' | t }}" autocorrect="off" autocapitalize="off" required />
                </label>
                <div class="label">
                    <p class="label-text-alt text-right"><a href="#" onclick="showRecoverPasswordForm();return false;">{{ 'Forgot your password?' | t }}</a></p>
                </div>
                <input type="submit" name="Submit" class="btn btn-primary" value="{{ 'Submit' | t }}">
            </div>
            {% if shop.settings.registration %}
            <p class="text-center">
                <small>{{ "Don't have an account yet?" | t }}</small>
                <br>
                <a href="/customer/register">{{ 'Register now' | t }}</a>
            </p>
            {% endif %}
        {% endform %}
        <div id="customer_recover_password" style="display: none;">
        {% form 'customer_recover_password' class:'customer' %}
            <div class="card-body">
                <h3 class="text-center">{{ 'Recover password' | t }}</h3>
                <p class="text-center">{{ "We will send you an email with a link to reset your password." | t }}</p>
                {% if request.query contains 'form-customer_recover_password=.errors' %}
                    <div class="alert alert-error">
                        <span>{{ 'Sorry, looks like something went wrong, please try again.' | t }}</span>
                    </div>
                {% endif %}
                {% if request.query contains 'form-customer_recover_password=.success' %}
                    {% assign recoverSuccess = true %}
                {% endif %}
                <div class="join w-full{% if form.errors contains 'email' %} input-error{% endif %}">
                    <div class="w-full">
                        <input class="input join-item w-full validator" type="email" name="customer[email]" value="" id="recover-email" placeholder="{{ 'Email' | t }}" autocorrect="off" autocapitalize="off" required />
                        <div class="validator-hint hidden m-0">{{ 'Enter valid email address' | t }}</div>
                    </div>
                    <input class="btn join-item w-36" type="submit" name="Submit" value="{{ 'Submit' | t }}">
                </div>
                <div class="alert text-center alert-success" id="recoverSuccess" style="display:none;">
                    {{ "We've sent you an email with a link to update your password." | t }}
                </div>
                <p class="text-center">{{ 'or' | t }} <a href="#" onclick="hideRecoverPasswordForm();return false;">{{ 'Login' | t }}</a></p>
            </div>
        {% endform %}
        </div>
    </div>
</section>

<script>
    function showRecoverPasswordForm() {
        document.getElementById('customer_recover_password').style.display = 'block';
        document.getElementById('customer_login').style.display='none';
        window.location.hash = '#recover_password-form';
    }
    function hideRecoverPasswordForm() {
        document.getElementById('customer_recover_password').style.display = 'none';
        document.getElementById('customer_login').style.display = 'block';
        window.location.hash = '';
    }
    // Allow deep linking to the recover password form
    if (window.location.hash == '#customer_recover_password-form') { showRecoverPasswordForm() }
    // recoverSuccess is only true when the recover form is
    {% if recoverSuccess %}
        document.getElementById('recoverSuccess').style.display = 'block';
    {% endif %}
</script>
